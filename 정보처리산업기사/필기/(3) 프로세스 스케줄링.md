# 프로세스 스케줄링
## 개요
* 비선점 스케줄링
  * 이미 할당된 CPU를 다른 프로세스가 뺏어 쓸 수 **없음**
  * 일괄 처리에 용이
  * 스케줄링 알고리즘으로 FCFS(FIFO), SJF, 우선순위, HRN, 기한부 존재
* 선점 스케줄링
  * 이미 할당된 CPU를 다른 프로세스가 뺏어 쓸 수 **있음**
  * 빠른 응답 시간을 요구하는 작업에 사용(대화식 시분할 시스템, 온라인 애플리케이션 등)
  * 스케줄링 알고리즘으로 Round Robin, SRT, 선점 우선순위, 다단계 큐, 다단계 피드백 큐 존재

## 비선점 스케줄링
### FCFS(선입선출)
단순한 큐로, 먼저 들어온 프로세스가 먼저 CPU를 할당받음.


<table>
  <tr>
    <th>프로세스 번호</th>
    <td>1</td>
    <td>2</td>
    <td>3</td>
  </tr>
  <tr>
    <th>실행시간</th>
    <td>10</td>
    <td>50</td>
    <td>30</td>
  </tr>
</table>

위와 같이 프로세스가 큐에 들어왔다고 했을 때, `평균 실행 시간`, `평균 대기 시간`, `평균 반환 시간`은 아래와 같이 구한다.

* `평균 실행 시간`: `(10 + 50 + 30) / 3 = 30`
* `평균 대기 시간`: `(0 + 10 + 50) / 3 = 20`
* `평균 반환 시간`: `(평균 실행 시간) + (평균 대기 시간) = (10 + 60 + 80)/3 = 50`

### SJF(Shortest Job First)
딘순한 우선순위 큐로, 실행 시간이 가장 짧은 프로세스가 먼저 CPU를 할당받음.

<table>
  <tr>
    <th>프로세스 번호</th>
    <td>1</td>
    <td>2</td>
    <td>3</td>
  </tr>
  <tr>
    <th>실행시간</th>
    <td>10</td>
    <td>50</td>
    <td>30</td>
  </tr>
</table>

프로세스가 위와 같이 큐에 들어와있는 상태라면 1 -> 3 -> 2 순으로 CPU를 할당한다. `평균 대기 시간`, `평균 반환 시간`은 아래와 같다.

* `평균 대기 시간`: `(0 + 10 + 30) / 3 = 13.333...`
* `평균 반환 시간`: `(10 + 40 + 50)/3 = 33.333...`

### HRN(Highest Response-ratio Next)
HR은 `(대기 시간 + 실행 시간) / 실행 시간`으로 계산하며, 대기시간이 길수록, 실행 시간이 짧을수록 우선권을 크게 부여한다. 즉 HR이 클수록 우선순위가 높다.

<table>
  <tr>
    <th>프로세스 번호</th>
    <td>1</td>
    <td>2</td>
    <td>3</td>
  </tr>
  <tr>
    <th>실행시간</th>
    <td>10</td>
    <td>50</td>
    <td>30</td>
  </tr>
  <tr>
    <th>대기시간</th>
    <td>10</td>
    <td>20</td>
    <td>10</td>
  </tr>
</table>

위와 같은 상태의 프로세스들이 큐에 들어온 상황일 때,
* 프로세스 1: `(10 + 10) / 10 = 2`
* 프로세스 2: `(20 + 50) / 50 = 1.4`
* 프로세스 3: `(10 + 30) / 30 = 1.333...`

이므로 1 -> 2 -> 3 순서대로 할당한다.

### 그 외
* 기한부: 일정한 시간 내에 처리하지 못하면 CPU에서 강제로 제거됨
* 우선순위: 프로세스마다 우선순위를 따로 부여하여 관리함(우선순위가 같으면 FCFS와 동일)

## 선점 스케줄링
### Round Robin
FCFS를 선점 방식으로 구현한 것. 프로세스에게 일정한 제한 시간을 두고 제한 시간 안에 완료하지 못하면 큐의 맨 뒤로 보내버리는 방식이다.

| 작업 | 입력 시간 | 직업 수행 시간 |
| --- | --- | --- |
| A | 10:00 | 5시간 |
| B | 10:30 | 10시간 |
| C | 12:00 | 15시간 |

제한 시간은 4시간일 때, 위와 같이 작업이 들어올 경우, CPU를 할당받는 순서는 `ABCABCBCC`이다.

### SRT(Shortest Remaining Time)
SJF를 선점 방식으로 구현한 것. 이미 할당된 프로세스와 큐에 새로 들어온 프로세스의 실행 시간을 비교하여, 가장 짧은 프로세스에게 CPU를 할당하는 방식이다.

### 다단계 큐(Multi-level Queue)
큐를 프로세스의 유형의 우선순위에 따라 여러개를 준비해 놓고, 서로 다른 스케줄링 기법을 사용하는 방식이다.

예를 들어 시스템 프로세스류는 가장 높은 우선순위에 속하고, 일괄 처리 프로세스류는 가장 낮은 우선순위에 속한다.

프로세스가 실행 도중 종류가 바뀔 일이 없기 때문에 한 프로세스가 다른 큐로 이동하지 못함.

### 다단계 피드백 큐(Multi-level Feedback Queue)
유형별로 큐를 준비해 두는 MQ와는 달리 유형이 없으며, 때문에 한 프로세스가 다른 큐로 이동할 수 있음.

각 큐마다 제한 시간을 두며, 제한시간 안에 작업을 완료하지 못한 프로세스는 다음 단계의 큐로 이동한다.

상위 단계 큐일 수록 제한 시간이 짧으며, 오래 기다린 프로세스의 경우 상위 단계로 이동한다.
